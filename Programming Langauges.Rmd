---
title: "Programming Languages"
author: "Rahim Jutha"
date: "2023-03-26"
output: html_document
---

# Load Packages

Important Variables
- title
- type
- appeared
- number_of_users
- number_of_jobs

```{r}
library(tidyverse)
library(glue)
library(ggtext)
library(scales)
library(ggview)
library(showtext)
library(patchwork)
```

# Load Data

```{r}
data <- read_csv("data/languages.csv")
```
# Load Fonts

```{r}
font_add_google(name = "Roboto Condensed", family = "Roboto Condensed")
font_add_google(name = "Bebas Neue", family = "BebasNeue")
showtext_auto()
showtext_opts(dpi = 300)
```

# Pre-processing
```{r}
df <- 
  data %>%
  select(title, type, appeared, number_of_jobs, number_of_users) %>%
  filter(type == 'pl') %>%
  mutate(
    title = case_when(
      title == "Arduino Programming Language" ~ "Arudino",
      TRUE ~ title
    ),
    lab1 = 
      glue("<span style=font-size:16pt>**{title} - {appeared}**</span><br><span style=font-size:14pt>{comma(number_of_users)}</span>"),
    lab2 =
      glue("<span style=font-size:16pt>**{title} | {appeared}**</span><br><span style=font-size:14pt>{number_of_jobs}</span>"),
    color = case_when(
      title == "R" ~ "dark",
      TRUE ~ "light",
    )
  )
```


# Visualisation
```{r}
plot1 <- 
  df %>%
  arrange(-number_of_users) %>%
  slice_head(n=10) %>%
  ggplot(aes(x = number_of_users, y = fct_reorder(title, number_of_users))) +
  geom_col(aes(fill = color)) +
  geom_richtext(aes(label = lab1), hjust = "inward", fill = NA, label.colour = NA, lineheight = .9) +
  
  labs(
    title = "<span style=font-size:24pt;font-family:BebasNeue>Number of Users</span>",
    fill = NULL,
    x = NULL,
    y = NULL
  ) +
  
  guides(
    fill = "none"
  ) +
  
  theme_minimal(base_family = "Roboto Condensed") +
  theme(
    plot.background = element_rect(fill = "grey70", color = NA),
    plot.margin = margin(10,0,10,0),
    plot.title.position = "plot",
    
    plot.title = element_markdown(hjust = .5),
    
    axis.text = element_blank(),
    panel.grid = element_blank()
  )

ggview(units = "in", height = 7, width = 5)
```

```{r}
plot2 <- 
  df %>%
  arrange(-number_of_jobs) %>%
  slice_head(n=10) %>%
  ggplot(aes(x = number_of_jobs, y = fct_reorder(title, number_of_jobs))) +
  geom_col(aes(fill = color)) +
  geom_richtext(aes(label = lab2), hjust = "inward", fill = NA, label.colour= NA, lineheight = .9 ) +
  
  labs(
    title = "<span style=font-size:24pt;font-family:BebasNeue>Number of Jobs</span>",
    fill = NULL,
    x = NULL,
    y = NULL
  ) +
  
  guides(
    fill = "none"
  ) +
  
  theme_minimal(base_family = "Roboto Condensed") +
  theme(
    plot.background = element_rect(fill = "grey70", color =  NA),
    plot.margin = margin(10,0,10,0),
    plot.title.position = "plot",
    
    plot.title = element_markdown(hjust = .5),
    
    axis.text = element_blank(),
    panel.grid = element_blank()
  )

ggview(units = "in", height = 7, width = 5)
```

```{r}
plot1 + plot2 +
  plot_layout(ncol = 2) +
  plot_annotation(
    title = "blank",
    subtitle = "blank",
    caption = "blank",
    # theme = theme(
    #   plot.background = element_rect(fill = "#F0F0F2", color = NA),
    #   panel.background = element_rect(fill = "#F0F0F2", color = NA), 
    #   plot.title = element_text(family = "Bebas Neue", color = "#3E4C59", size = 125, hjust = 0.5, margin = margin(t = 10, b = 10)),
    #   plot.caption = element_text(family = "Roboto Condensed", color = "#3E4C59", size = 30, hjust = 0.5))
  )


ggview(units = "in", height = 7, width = 10)
```